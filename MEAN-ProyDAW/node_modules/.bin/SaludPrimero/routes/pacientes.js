var express = require('express');
var router = express.Router();
var mongoose=require('mongoose');
var Usuario=require('../models/Usuario.js');
router.get('/', function (req, res) {

  console.log('I received a get request');
    Usuario.find({cedula:req.session["cedula"]}, function (err, docs) {
        console.log(docs);
        res.json(docs);

    });
});
router.put('/', function(req, res) {

var cedula=req.body.cedula;
var nombres=req.body.nombres;
var correo= req.body.correo;
var dir =req.body.direccion1;
var ape=req.body.apellidos;
console.log(cedula);
console.log(nombres);
console.log(correo);
console.log(ape);
console.log(dir);
	Usuario.findByIdAndUpdate(req.session["idPaciente"],
  		{ $set: { nombres: req.body.nombres,
  				      apellidos: req.body.apellidos,
  				      correo: req.body.correo,
                direccion:req.body.direccion1,
                cedula:req.body.cedula


        }
				}, function (err, doc) {
  		if (err) {
  			res.send(err);
  		} else {
        req.session.cedula=req.body.cedula;
  			res.json(doc);
  		}
	});
});
var db = mongoose.connection;
db.on('error', console.error.bind(console, 'connection error:'));
db.once('open', function() {console.log("query get de mis datos con exito");});
module.exports = router;
